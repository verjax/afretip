{
  "test_file": "lol_05_regsvr32_bypass.json",
  "test_category": "malicious",
  "timestamp": "2025-08-18T20:06:30.334545",
  "processing_time": 165.52580738067627,
  "success": true,
  "metrics": {
    "iocs_extracted": 12,
    "findings_generated": 12,
    "rules_generated": 7,
    "ioc_extraction_time": 165.172,
    "threat_classifications": {
      "malicious": 12
    },
    "confidence_scores": [
      0.8,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0
    ],
    "threat_levels": {
      "high": 12
    },
    "rule_generation_efficiency": 0.5833333333333334
  },
  "memory_delta_mb": 0.0,
  "peak_memory_mb": 26.98,
  "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 20:03:45 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/living_off_land/lol_05_regsvr32_bypass.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 20:03:45 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 20:03:45 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:03:45 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:03:45 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:03:45 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:03:45 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:03:45 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:03:45 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:03:45 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:03:45 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:03:45 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:03:45 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:03:45 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:03:45 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:03:45 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 20:03:45 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 20:03:45 [info     ] Threat intelligence database schema initialized\n2025-08-18 20:03:45 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 20:03:45 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 20:03:45 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 20:03:45 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 20:03:45 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 20:03:45 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 20:03:45 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:03:45 [info     ] Parsing existing rules from: data/rules\n2025-08-18 20:03:45 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 20:03:45 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 20:03:45 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_200345\n2025-08-18 20:03:45 [info     ] Analytics metrics enabled for data collection\n2025-08-18 20:03:45 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 20:03:45 [debug    ] Enhanced IOC extraction completed context=unknown extraction_time=0.001s iocs_found=12 log_hash=5543dc716852491cb063be897b9b84d5\n2025-08-18 20:03:48 [info     ] Threat detected                classification=malicious confidence=0.8 ioc_type=ip ioc_value=192.168.1.10 threat_level=high\n2025-08-18 20:03:48 [debug    ] VirusTotal rate limiting       sleep_time=11.890610694885254\n2025-08-18 20:04:00 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=domain ioc_value=regsvr32.exe threat_level=high\n2025-08-18 20:04:00 [debug    ] VirusTotal rate limiting       sleep_time=14.407636165618896\n2025-08-18 20:04:15 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=domain ioc_value=payload.bad.ml threat_level=high\n2025-08-18 20:04:15 [debug    ] VirusTotal rate limiting       sleep_time=14.36536455154419\n2025-08-18 20:04:30 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=domain ioc_value=evil.sct threat_level=high\n2025-08-18 20:04:30 [debug    ] VirusTotal rate limiting       sleep_time=14.501724481582642\n2025-08-18 20:04:45 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=domain ioc_value=scrobj.dll threat_level=high\n2025-08-18 20:04:45 [debug    ] VirusTotal rate limiting       sleep_time=14.440585851669312\n2025-08-18 20:05:00 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=domain ioc_value=cmd.exe threat_level=high\n2025-08-18 20:05:00 [debug    ] VirusTotal rate limiting       sleep_time=14.512904644012451\n2025-08-18 20:05:15 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=url ioc_value=http://payload.bad.ml/evil.sct threat_level=high\n2025-08-18 20:05:15 [debug    ] VirusTotal rate limiting       sleep_time=14.470214366912842\n2025-08-18 20:05:30 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:05:30 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=//payload.bad.ml/evil.sct threat_level=high\n2025-08-18 20:05:30 [debug    ] VirusTotal rate limiting       sleep_time=14.999327421188354\n2025-08-18 20:05:45 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:05:45 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\regsvr32.exe threat_level=high\n2025-08-18 20:05:45 [debug    ] VirusTotal rate limiting       sleep_time=14.999162435531616\n2025-08-18 20:06:00 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 20:06:00 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\cmd.exe threat_level=high\n2025-08-18 20:06:00 [debug    ] VirusTotal rate limiting       sleep_time=14.998378038406372\n2025-08-18 20:06:15 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 20:06:15 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=process_name ioc_value=regsvr32.exe threat_level=high\n2025-08-18 20:06:15 [debug    ] VirusTotal rate limiting       sleep_time=14.9984130859375\n2025-08-18 20:06:30 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 20:06:30 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=process_name ioc_value=cmd.exe threat_level=high\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=66dff8658e5c49e98687b64d135bb1a4 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=bb87cd855eae4504bade0cc9c82faa42 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=f91f90772a924b299116ac4cad957981 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=5ad80e3706f542738e30a20f3e8ff35a new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=4b108d3690124e5ebbd109ba4b39b86a new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=704ddde3e9d04403adfa80fb1e4911e4 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=f7ce1f2a039a46b7a1203a2d77df5e08 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=5a5394d3da5b4e02b3596881eda31f86 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=dff69bb9ec6f428f809685fe461c6700 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=ef6aaf0a818b411aa4fa1415ab11671b new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=6605d6f27e824e06a7e9216212484b24 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 20:06:30 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=e592ff65082b494680b307e1201f04d9 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 12\n  \u2022 Findings generated: 12\n  \u2022 Rules generated: 7\n  \u2022 Processing time: 165.172s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.IP: 192.168.1.10 (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: regsvr32.exe (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: payload.bad.ml (confidence: 1.00)\n  \u2022 IOCType.DOMAIN: evil.sct (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: scrobj.dll (confidence: 0.70)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
  "errors": ""
}